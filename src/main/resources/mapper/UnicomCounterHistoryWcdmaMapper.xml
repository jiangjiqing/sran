<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hongshen.sran_service.dao.UnicomCounterHistoryWcdmaMapper">
  <resultMap id="BaseResultMap" type="com.hongshen.sran_service.entity.UnicomCounterHistoryWcdma">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->

    <result column="name" jdbcType="VARCHAR" property="name" />
    <result column="time" jdbcType="TIMESTAMP" property="time" />
    <result column="counter1" jdbcType="VARCHAR" property="counter1" />
    <result column="counter2" jdbcType="VARCHAR" property="counter2" />
    <result column="counter3" jdbcType="VARCHAR" property="counter3" />
    <result column="counter4" jdbcType="VARCHAR" property="counter4" />
    <result column="counter5" jdbcType="VARCHAR" property="counter5" />
    <result column="counter6" jdbcType="VARCHAR" property="counter6" />
    <result column="counter7" jdbcType="VARCHAR" property="counter7" />
    <result column="counter8" jdbcType="VARCHAR" property="counter8" />
    <result column="counter9" jdbcType="VARCHAR" property="counter9" />
    <result column="counter10" jdbcType="VARCHAR" property="counter10" />
    <result column="counter11" jdbcType="VARCHAR" property="counter11" />
    <result column="counter12" jdbcType="VARCHAR" property="counter12" />
    <result column="counter13" jdbcType="VARCHAR" property="counter13" />
    <result column="counter14" jdbcType="VARCHAR" property="counter14" />
    <result column="counter15" jdbcType="VARCHAR" property="counter15" />
    <result column="counter16" jdbcType="VARCHAR" property="counter16" />
    <result column="counter17" jdbcType="VARCHAR" property="counter17" />
    <result column="counter18" jdbcType="VARCHAR" property="counter18" />
    <result column="counter19" jdbcType="VARCHAR" property="counter19" />
    <result column="counter20" jdbcType="VARCHAR" property="counter20" />
    <result column="counter21" jdbcType="VARCHAR" property="counter21" />
    <result column="counter22" jdbcType="VARCHAR" property="counter22" />
    <result column="counter23" jdbcType="VARCHAR" property="counter23" />
    <result column="counter24" jdbcType="VARCHAR" property="counter24" />
    <result column="counter25" jdbcType="VARCHAR" property="counter25" />
    <result column="counter26" jdbcType="VARCHAR" property="counter26" />
    <result column="counter27" jdbcType="VARCHAR" property="counter27" />
    <result column="counter28" jdbcType="VARCHAR" property="counter28" />
    <result column="counter29" jdbcType="VARCHAR" property="counter29" />
    <result column="counter30" jdbcType="VARCHAR" property="counter30" />
    <result column="counter31" jdbcType="VARCHAR" property="counter31" />
    <result column="counter32" jdbcType="VARCHAR" property="counter32" />
    <result column="counter33" jdbcType="VARCHAR" property="counter33" />
    <result column="counter34" jdbcType="VARCHAR" property="counter34" />
    <result column="counter35" jdbcType="VARCHAR" property="counter35" />
    <result column="counter36" jdbcType="VARCHAR" property="counter36" />
    <result column="counter37" jdbcType="VARCHAR" property="counter37" />
    <result column="counter38" jdbcType="VARCHAR" property="counter38" />
    <result column="counter39" jdbcType="VARCHAR" property="counter39" />
    <result column="counter40" jdbcType="VARCHAR" property="counter40" />
  </resultMap>
  <insert id="insert" parameterType="com.hongshen.sran_service.entity.UnicomCounterHistoryWcdma">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into unicom_counter_history_wcdma (name, time, counter1, 
      counter2, counter3, counter4, 
      counter5, counter6, counter7, 
      counter8, counter9, counter10, 
      counter11, counter12, counter13, 
      counter14, counter15, counter16, 
      counter17, counter18, counter19, 
      counter20, counter21, counter22, 
      counter23, counter24, counter25, 
      counter26, counter27, counter28, 
      counter29, counter30, counter31, 
      counter32, counter33, counter34, 
      counter35, counter36, counter37, 
      counter38, counter39, counter40
      )
    values (#{name,jdbcType=VARCHAR}, #{time,jdbcType=TIMESTAMP}, #{counter1,jdbcType=VARCHAR}, 
      #{counter2,jdbcType=VARCHAR}, #{counter3,jdbcType=VARCHAR}, #{counter4,jdbcType=VARCHAR}, 
      #{counter5,jdbcType=VARCHAR}, #{counter6,jdbcType=VARCHAR}, #{counter7,jdbcType=VARCHAR}, 
      #{counter8,jdbcType=VARCHAR}, #{counter9,jdbcType=VARCHAR}, #{counter10,jdbcType=VARCHAR}, 
      #{counter11,jdbcType=VARCHAR}, #{counter12,jdbcType=VARCHAR}, #{counter13,jdbcType=VARCHAR}, 
      #{counter14,jdbcType=VARCHAR}, #{counter15,jdbcType=VARCHAR}, #{counter16,jdbcType=VARCHAR}, 
      #{counter17,jdbcType=VARCHAR}, #{counter18,jdbcType=VARCHAR}, #{counter19,jdbcType=VARCHAR}, 
      #{counter20,jdbcType=VARCHAR}, #{counter21,jdbcType=VARCHAR}, #{counter22,jdbcType=VARCHAR}, 
      #{counter23,jdbcType=VARCHAR}, #{counter24,jdbcType=VARCHAR}, #{counter25,jdbcType=VARCHAR}, 
      #{counter26,jdbcType=VARCHAR}, #{counter27,jdbcType=VARCHAR}, #{counter28,jdbcType=VARCHAR}, 
      #{counter29,jdbcType=VARCHAR}, #{counter30,jdbcType=VARCHAR}, #{counter31,jdbcType=VARCHAR}, 
      #{counter32,jdbcType=VARCHAR}, #{counter33,jdbcType=VARCHAR}, #{counter34,jdbcType=VARCHAR}, 
      #{counter35,jdbcType=VARCHAR}, #{counter36,jdbcType=VARCHAR}, #{counter37,jdbcType=VARCHAR}, 
      #{counter38,jdbcType=VARCHAR}, #{counter39,jdbcType=VARCHAR}, #{counter40,jdbcType=VARCHAR}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.hongshen.sran_service.entity.UnicomCounterHistoryWcdma">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into unicom_counter_history_wcdma
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="name != null">
        name,
      </if>
      <if test="time != null">
        time,
      </if>
      <if test="counter1 != null">
        counter1,
      </if>
      <if test="counter2 != null">
        counter2,
      </if>
      <if test="counter3 != null">
        counter3,
      </if>
      <if test="counter4 != null">
        counter4,
      </if>
      <if test="counter5 != null">
        counter5,
      </if>
      <if test="counter6 != null">
        counter6,
      </if>
      <if test="counter7 != null">
        counter7,
      </if>
      <if test="counter8 != null">
        counter8,
      </if>
      <if test="counter9 != null">
        counter9,
      </if>
      <if test="counter10 != null">
        counter10,
      </if>
      <if test="counter11 != null">
        counter11,
      </if>
      <if test="counter12 != null">
        counter12,
      </if>
      <if test="counter13 != null">
        counter13,
      </if>
      <if test="counter14 != null">
        counter14,
      </if>
      <if test="counter15 != null">
        counter15,
      </if>
      <if test="counter16 != null">
        counter16,
      </if>
      <if test="counter17 != null">
        counter17,
      </if>
      <if test="counter18 != null">
        counter18,
      </if>
      <if test="counter19 != null">
        counter19,
      </if>
      <if test="counter20 != null">
        counter20,
      </if>
      <if test="counter21 != null">
        counter21,
      </if>
      <if test="counter22 != null">
        counter22,
      </if>
      <if test="counter23 != null">
        counter23,
      </if>
      <if test="counter24 != null">
        counter24,
      </if>
      <if test="counter25 != null">
        counter25,
      </if>
      <if test="counter26 != null">
        counter26,
      </if>
      <if test="counter27 != null">
        counter27,
      </if>
      <if test="counter28 != null">
        counter28,
      </if>
      <if test="counter29 != null">
        counter29,
      </if>
      <if test="counter30 != null">
        counter30,
      </if>
      <if test="counter31 != null">
        counter31,
      </if>
      <if test="counter32 != null">
        counter32,
      </if>
      <if test="counter33 != null">
        counter33,
      </if>
      <if test="counter34 != null">
        counter34,
      </if>
      <if test="counter35 != null">
        counter35,
      </if>
      <if test="counter36 != null">
        counter36,
      </if>
      <if test="counter37 != null">
        counter37,
      </if>
      <if test="counter38 != null">
        counter38,
      </if>
      <if test="counter39 != null">
        counter39,
      </if>
      <if test="counter40 != null">
        counter40,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="name != null">
        #{name,jdbcType=VARCHAR},
      </if>
      <if test="time != null">
        #{time,jdbcType=TIMESTAMP},
      </if>
      <if test="counter1 != null">
        #{counter1,jdbcType=VARCHAR},
      </if>
      <if test="counter2 != null">
        #{counter2,jdbcType=VARCHAR},
      </if>
      <if test="counter3 != null">
        #{counter3,jdbcType=VARCHAR},
      </if>
      <if test="counter4 != null">
        #{counter4,jdbcType=VARCHAR},
      </if>
      <if test="counter5 != null">
        #{counter5,jdbcType=VARCHAR},
      </if>
      <if test="counter6 != null">
        #{counter6,jdbcType=VARCHAR},
      </if>
      <if test="counter7 != null">
        #{counter7,jdbcType=VARCHAR},
      </if>
      <if test="counter8 != null">
        #{counter8,jdbcType=VARCHAR},
      </if>
      <if test="counter9 != null">
        #{counter9,jdbcType=VARCHAR},
      </if>
      <if test="counter10 != null">
        #{counter10,jdbcType=VARCHAR},
      </if>
      <if test="counter11 != null">
        #{counter11,jdbcType=VARCHAR},
      </if>
      <if test="counter12 != null">
        #{counter12,jdbcType=VARCHAR},
      </if>
      <if test="counter13 != null">
        #{counter13,jdbcType=VARCHAR},
      </if>
      <if test="counter14 != null">
        #{counter14,jdbcType=VARCHAR},
      </if>
      <if test="counter15 != null">
        #{counter15,jdbcType=VARCHAR},
      </if>
      <if test="counter16 != null">
        #{counter16,jdbcType=VARCHAR},
      </if>
      <if test="counter17 != null">
        #{counter17,jdbcType=VARCHAR},
      </if>
      <if test="counter18 != null">
        #{counter18,jdbcType=VARCHAR},
      </if>
      <if test="counter19 != null">
        #{counter19,jdbcType=VARCHAR},
      </if>
      <if test="counter20 != null">
        #{counter20,jdbcType=VARCHAR},
      </if>
      <if test="counter21 != null">
        #{counter21,jdbcType=VARCHAR},
      </if>
      <if test="counter22 != null">
        #{counter22,jdbcType=VARCHAR},
      </if>
      <if test="counter23 != null">
        #{counter23,jdbcType=VARCHAR},
      </if>
      <if test="counter24 != null">
        #{counter24,jdbcType=VARCHAR},
      </if>
      <if test="counter25 != null">
        #{counter25,jdbcType=VARCHAR},
      </if>
      <if test="counter26 != null">
        #{counter26,jdbcType=VARCHAR},
      </if>
      <if test="counter27 != null">
        #{counter27,jdbcType=VARCHAR},
      </if>
      <if test="counter28 != null">
        #{counter28,jdbcType=VARCHAR},
      </if>
      <if test="counter29 != null">
        #{counter29,jdbcType=VARCHAR},
      </if>
      <if test="counter30 != null">
        #{counter30,jdbcType=VARCHAR},
      </if>
      <if test="counter31 != null">
        #{counter31,jdbcType=VARCHAR},
      </if>
      <if test="counter32 != null">
        #{counter32,jdbcType=VARCHAR},
      </if>
      <if test="counter33 != null">
        #{counter33,jdbcType=VARCHAR},
      </if>
      <if test="counter34 != null">
        #{counter34,jdbcType=VARCHAR},
      </if>
      <if test="counter35 != null">
        #{counter35,jdbcType=VARCHAR},
      </if>
      <if test="counter36 != null">
        #{counter36,jdbcType=VARCHAR},
      </if>
      <if test="counter37 != null">
        #{counter37,jdbcType=VARCHAR},
      </if>
      <if test="counter38 != null">
        #{counter38,jdbcType=VARCHAR},
      </if>
      <if test="counter39 != null">
        #{counter39,jdbcType=VARCHAR},
      </if>
      <if test="counter40 != null">
        #{counter40,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>

  <select id="getCounterHistoryListByTimeOld" resultType="com.alibaba.fastjson.JSONObject">

    SELECT
    name, time,
    counter1 pmNoIuSigEstablishSuccessCs, counter2 pmNoIuSigEstablishAttemptCs,
    counter3 pmNoIuSigEstablishSuccessPs, counter4 pmNoIuSigEstablishAttemptPs,
    counter5 pmTotNoRrcConnectReqSuccess, counter6 pmTotNoRrcConnectReq,
    counter7 pmNoLoadSharingRrcConn, counter8 pmTotNoRrcConnectReqPsSucc,
    counter9 pmTotNoRrcConnectReqPs, counter10 pmNoLoadSharingRrcConnPs,
    counter11 pmTotNoRrcConnectReqCsSucc, counter12 pmTotNoRrcConnectReqCs,
    counter13 pmNoLoadSharingRrcConnCs, counter14 pmNoRabEstablishSuccessSpeech,
    counter15 pmNoRabEstablishAttemptSpeech, counter16 pmNoRabEstablishSuccessPacketInteractive,
    counter17 pmNoRabEstablishAttemptPacketInteractive, counter18 pmNoTimesRlAddToActSet,
    counter19 pmNoTimesCellFailAddToActSet, counter20 pmNoSystemRabReleaseSpeech,
    counter21 pmNoNormalRabReleaseSpeech, counter22 pmNoSystemRabReleasePacket,
    counter23 pmNoSystemRabReleasePacketUra, counter24 pmChSwitchAttemptFachUra,
    counter25 pmChSwitchSuccFachUra, counter26 pmChSwitchAttemptDchUra,
    counter27 pmChSwitchSuccDchUra, counter28 pmChSwitchAttemptHsUra,
    counter29 pmChSwitchSuccHsUra, counter30 pmNoNormalRabReleasePacket,
    counter31 pmNoNormalRabReleasePacketUra, counter32,
    counter33, counter34, counter35, counter36,
    counter37, counter38, counter39, counter40
    FROM unicom_counter_history_wcdma
    WHERE time = #{time}
  </select>

  <select id="getCellListByIdAndTime" parameterType="java.util.List" resultType="com.alibaba.fastjson.JSONObject">

    SELECT
    *
    FROM unicom_counter_history_wcdma
    WHERE
    name in
    <foreach close=")" collection="nameList" index="index" item="name" open="(" separator=",">
      #{name}
    </foreach>
    and time = #{time}
  </select>

  <select id="getSumCellsCounterByCellsAndTime" parameterType="java.util.List" resultType="java.lang.String">

    SELECT
    sum(#{counter})
    FROM unicom_counter_history_wcdma
    WHERE name in
    <foreach close=")" collection="nameList" index="index" item="name" open="(" separator=",">
      #{name}
    </foreach>
    and time = #{time}
  </select>

  <select id="getSumAllCounterByTimeAndCounterList" parameterType="java.util.List" resultType="com.alibaba.fastjson.JSONObject">

    SELECT
    t1.node_name nodeName,
    <foreach collection="counterList" index="index" item="counter" separator=",">
      sum(t2.${counter}) ${counter}
    </foreach>
    FROM
    (
    SELECT
    cell_name,
    node_name
    FROM unicom_cell_wcdma
    ) t1
    left JOIN
    (
    SELECT
    name,
    time,
    <foreach collection="counterList" index="index" item="counter" separator=",">
      ${counter}
    </foreach>
    FROM
    unicom_counter_history_wcdma
    ) t2
    on t1.cell_name = t2.name
    WHERE t2.time = #{time}
    GROUP BY t1.node_name
  </select>

  <select id="getCounterHistoryListByTime" resultType="com.alibaba.fastjson.JSONObject">

    SELECT
    *
    FROM unicom_counter_history_wcdma
    WHERE time = #{time}
  </select>

  <select id="dowloadCounter" parameterType="java.util.Date" resultType="com.alibaba.fastjson.JSONObject">
    SELECT *
    FROM unicom_counter_history_wcdma
    <if test="start!=null and end !=null and condition==null">
      WHERE time  BETWEEN #{start} AND #{end}
    </if>
    <if test="start!=null and end !=null and condition!=null">
      ${condition} AND time  BETWEEN #{start} AND #{end}
    </if>
    <if test="start==null and end ==null and condition!=null">
      ${condition}
    </if>
    ORDER BY time DESC;
  </select>

  <select id="getBadTenCell" parameterType="java.util.List" resultType="com.alibaba.fastjson.JSONObject">
    SELECT
    name,
    IFNULL(#{expression},0) expvalue
    FROM
    unicom_counter_history_wcdma
    WHERE
    name in
    <foreach collection="cellList" item="cell" index="index" open="(" separator="," close=")">
      #{cell}
    </foreach>
    and time = #{time}
    ORDER BY expvalue DESC
    LIMIT 10
  </select>

  <select id="getCounterTime" resultType="com.alibaba.fastjson.JSONObject">
    SELECT time FROM unicom_counter_history_wcdma
  </select>

  <select id="addColumnCounter" parameterType="java.lang.String">

    alter table unicom_counter_history_wcdma add ${name} varchar(5) Null;

  </select>
</mapper>